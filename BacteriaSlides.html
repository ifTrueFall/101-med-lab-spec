<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="icon" type="image/svg+xml"
        href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ctext x='-27' y='75' font-family='Courier' font-size='117' fill='%23000'%3Eâ˜•%3C/text%3E%3C/svg%3E" />
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Microbe Identification Quiz</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        /* Custom styles for button feedback */
        .correct-answer {
            background-color: #556B2F !important;
            border-color: #4A5D28 !important;
            color: white !important;
        }
        .wrong-answer {
            background-color: #8B4513 !important;
            border-color: #7A3E12 !important;
            color: white !important;
        }
        .disabled-options button {
            cursor: not-allowed;
            opacity: 0.7;
        }
    </style>
</head>
<body class="bg-amber-950 text-stone-300">

    <!-- Navigation Bar -->
    <nav class="bg-stone-800 shadow-md">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <!-- Left side of Navbar -->
                <div class="flex-shrink-0">
                    <a href="https://iftruefall.github.io/101-med-lab-spec/navigation.html" class="text-xl font-bold text-amber-300 hover:text-amber-200">Nav</a>
                </div>
                <!-- Right side of Navbar -->
                <div class="hidden md:block">
                    <div class="ml-4 flex items-center md:ml-6">
                        <ul class="flex space-x-4">
                            <li><a href="#" class="text-stone-300 hover:bg-stone-700 hover:text-stone-200 px-3 py-2 rounded-md text-sm font-medium"></a></li> <!--not sure what i wanna link yet-->
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Quiz Content -->
    <main class="max-w-4xl mx-auto mt-4 sm:mt-8 p-3 sm:p-5 bg-stone-800 rounded-2xl shadow-lg">
        <div class="text-center mb-4">
            <h1 class="text-2xl sm:text-3xl font-bold text-amber-200 mb-2">Microbe Identification Quiz</h1>
            <p class="text-stone-400">Identify the microbes shown in the image below.</p>
        </div>

        <div class="flex flex-col md:flex-row md:items-start md:gap-8">
            <!-- Left Column: Image -->
            <div class="w-full md:w-1/2 mb-4 md:mb-0">
                <div class="max-w-md mx-auto bg-stone-900 rounded-lg overflow-hidden border-4 border-stone-700">
                    <img id="Microbe-image" src="https://placehold.co/500x500/1c1917/a8a29e?text=Loading+Image..." alt="Microbe Image" class="w-full h-auto object-cover">
                </div>
            </div>

            <!-- Right Column: Controls -->
            <div class="w-full md:w-1/2 flex flex-col">
                <!-- Score Tracker -->
                <div id="score-container" class="text-lg font-semibold text-amber-400 mb-4 text-center md:text-left">
                    Score: <span id="score">0</span> / <span id="total-questions">0</span>
                </div>

                <!-- Options Container -->
                <div id="options-container" class="grid grid-cols-1 sm:grid-cols-2 gap-3 mb-4">
                    <!-- Answer buttons will be dynamically inserted here -->
                </div>

                <!-- Feedback and Next Button -->
                <div id="feedback-container" class="mt-auto">
                    <p id="feedback-text" class="text-xl text-center md:text-left font-bold mb-2 min-h-[28px]"></p>
                    <button id="next-question-btn" class="hidden w-full bg-amber-700 text-amber-50 font-bold py-3 px-6 rounded-lg hover:bg-amber-600 transition duration-300 ease-in-out transform hover:scale-105">
                        Next Question
                    </button>
                </div>
            </div>
        </div>
    </main>

    <script>
        // --- DATA SETUP ---
        const MicTypes = [
            { name: "Hymenolepis diminuta", count: 2 },
            { name: "Dipylidium caninum", count: 2 },
            { name: "Dientamoeba fragilis", count: 5 },
            { name: "Chilomastix mesnili", count: 8 },
            { name: "Plasmodium vivax-ovale", count: 5 },
            { name: "Trichuris trichuria", count: 2 },
            { name: "Ascaris lumbricoides", count: 2 },
            { name: "Plasmodium malariae", count: 6 },
            { name: "Iodamoeba butschlii1", count: 9 },
            { name: "Microfilaria spp", count: 2 },
            { name: "Toxoplasma gondii", count: 3 },
            { name: "P westermani", count: 2 },
            { name: "Plasmodium falciparum", count: 3 },
            { name: "S. japonicum", count: 1 },
            { name: "Wuchereria bancrofti", count: 2 },
            { name: "Fasciola hepatica", count: 3 },
            { name: "Giardia lamblia", count: 4 },
            { name: "Paragon west", count: 2 },
            { name: "Taenia spp", count: 2 },
            { name: "Balantidium coli", count: 2 },
            { name: "Toxocara spp", count: 2 },
            { name: "S. mansoni", count: 2 },
            { name: "Opisthorchis spp", count: 1 },
            { name: "Trypanosoma brucei", count: 2 },
            { name: "Babesia spp", count: 2 },
            { name: "Trypanosoma cruzi", count: 1 },
            { name: "Entamoeba coli", count: 2 },
            { name: "Trichinella spiralis", count: 1 }
        ];

        // --- DOM ELEMENT REFERENCES ---
        const MicrobeImage = document.getElementById('Microbe-image');
        const optionsContainer = document.getElementById('options-container');
        const feedbackText = document.getElementById('feedback-text');
        const nextQuestionBtn = document.getElementById('next-question-btn');
        const scoreEl = document.getElementById('score');
        const totalQuestionsEl = document.getElementById('total-questions');

        // --- STATE MANAGEMENT ---
        let currentCorrectAnswer = '';
        let score = 0;
        let totalQuestions = 0;
        let isAnswered = false;

        // --- HELPER FUNCTIONS ---
        /**
         * Generates a random integer between 0 and a max value (exclusive).
         * @param {number} max - The upper bound for the random number.
         * @returns {number} A random integer.
         */
        function getRandomInt(max) {
            return Math.floor(Math.random() * max);
        }

        /**
         * Shuffles an array in place using the Fisher-Yates algorithm.
         * @param {Array} array - The array to be shuffled.
         */
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }

        // --- CORE QUIZ LOGIC ---
        /**
         * Generates and displays a new quiz question.
         */
        function generateQuestion() {
            // 1. Reset the UI state
            isAnswered = false;
            feedbackText.textContent = '';
            feedbackText.className = 'text-xl text-center md:text-left font-bold mb-2 min-h-[28px]'; // Reset classes
            nextQuestionBtn.classList.add('hidden');
            optionsContainer.innerHTML = '';
            optionsContainer.classList.remove('disabled-options');

            // 2. Select a random Microbe type for the correct answer
            const correctTypeIndex = getRandomInt(MicTypes.length);
            const correctType = MicTypes[correctTypeIndex];
            currentCorrectAnswer = correctType.name;

            // 3. Select a random image number for that type
            const imageNumber = getRandomInt(correctType.count) + 1; // +1 because counts are 1-based
            const imageName = `${correctType.name}${imageNumber}.png`;
            
            // 4. Update the image source
            MicrobeImage.src = `MicTeria/${imageName}`;
            MicrobeImage.alt = `Image of a ${correctType.name}`;
            MicrobeImage.onerror = () => {
                MicrobeImage.src = `https://placehold.co/500x500/1c1917/a8a29e?text=Image+not+found`;
            }

            // 5. Generate answer options (1 correct, 3 incorrect)
            const options = [correctType.name];
            const wrongTypes = MicTypes.filter(type => type.name !== correctType.name);
            shuffleArray(wrongTypes); // Randomize the incorrect options
            for (let i = 0; i < 3 && i < wrongTypes.length; i++) {
                options.push(wrongTypes[i].name);
            }
            
            shuffleArray(options);

            // 6. Create and display the answer buttons
            options.forEach(option => {
                const button = document.createElement('button');
                button.textContent = option;
                button.classList.add('w-full', 'bg-stone-700', 'text-stone-200', 'font-semibold', 'py-3', 'px-4', 'border', 'border-stone-600', 'rounded-lg', 'shadow-sm', 'hover:bg-stone-600', 'transition', 'duration-200');
                button.onclick = () => checkAnswer(option, button);
                optionsContainer.appendChild(button);
            });
        }

        /**
         * Checks the user's selected answer against the correct answer.
         * @param {string} selectedOption - The text content of the button the user clicked.
         * @param {HTMLElement} buttonElement - The button element that was clicked.
         */
        function checkAnswer(selectedOption, buttonElement) {
            if (isAnswered) return;
            isAnswered = true;

            totalQuestions++;
            totalQuestionsEl.textContent = totalQuestions;
            optionsContainer.classList.add('disabled-options');

            if (selectedOption === currentCorrectAnswer) {
                // Correct Answer
                score++;
                scoreEl.textContent = score;
                feedbackText.textContent = 'Correct!';
                feedbackText.classList.add('text-lime-400');
                buttonElement.classList.add('correct-answer');
            } else {
                // Incorrect Answer
                feedbackText.textContent = `Incorrect! The answer was ${currentCorrectAnswer}.`;
                feedbackText.classList.add('text-orange-400');
                buttonElement.classList.add('wrong-answer');
                
                // Highlight the correct answer
                Array.from(optionsContainer.children).forEach(btn => {
                    if (btn.textContent === currentCorrectAnswer) {
                        btn.classList.add('correct-answer');
                    }
                });
            }

            // Show the "Next Question" button
            nextQuestionBtn.classList.remove('hidden');
        }

        // --- EVENT LISTENERS ---
        nextQuestionBtn.addEventListener('click', generateQuestion);

        // --- INITIALIZATION ---
        // Load the first question when the page loads
        window.onload = generateQuestion;
    </script>

</body>
</html>
