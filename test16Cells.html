<!DOCTYPE html>
<html lang="en">
<head>
  <link rel="icon" type="image/svg+xml"
    href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ctext x='-27' y='75' font-family='Courier' font-size='117' fill='%23000'%3Eâ˜•%3C/text%3E%3C/svg%3E" />
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WBC Identification Quiz</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        /* Custom styles for button feedback */
        .correct-answer {
            background-color: #22c55e !important; /* Tailwind green-500 */
            border-color: #16a34a !important; /* Tailwind green-600 */
            color: white !important;
        }
        .wrong-answer {
            background-color: #ef4444 !important; /* Tailwind red-500 */
            border-color: #dc2626 !important; /* Tailwind red-600 */
            color: white !important;
        }
        .disabled-options button {
            cursor: not-allowed;
            opacity: 0.7;
        }
    </style>
</head>
<body class="bg-stone-200 text-stone-800">

    <!-- Navigation Bar -->
    <nav class="bg-stone-50 shadow-md">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <!-- Left side of Navbar -->
                <div class="flex-shrink-0">
                    <a href="test16.html" class="text-xl font-bold text-amber-900 hover:text-amber-950">WBC's</a>
                </div>
                <!-- Right side of Navbar -->
                <div class="hidden md:block">
                    <div class="ml-4 flex items-center md:ml-6">
                        <ul class="flex space-x-4">
                            <li><a href="navigation.html" class="text-stone-600 hover:bg-stone-200 hover:text-stone-900 px-3 py-2 rounded-md text-sm font-medium">Other MLT's</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Quiz Content -->
    <main class="max-w-4xl mx-auto mt-4 sm:mt-8 p-3 sm:p-5 bg-stone-50 rounded-2xl shadow-lg">
        <div class="text-center mb-4">
             <h1 class="text-2xl sm:text-3xl font-bold text-stone-900 mb-2">WBC Identification Quiz</h1>
             <p class="text-stone-600">Identify the cell shown in the image below.</p>
        </div>

        <div class="flex flex-col md:flex-row md:items-start md:gap-8">
            <!-- Left Column: Image -->
            <div class="w-full md:w-1/2 mb-4 md:mb-0">
                <div class="max-w-md mx-auto bg-stone-200 rounded-lg overflow-hidden border-4 border-stone-300">
                    <img id="wbc-image" src="https://placehold.co/500x500/e5e7eb/44403c?text=Loading+Image..." alt="WBC Image" class="w-full h-auto object-cover">
                </div>
            </div>

            <!-- Right Column: Controls -->
            <div class="w-full md:w-1/2 flex flex-col">
                <!-- Score Tracker -->
                <div id="score-container" class="text-lg font-semibold text-amber-900 mb-4 text-center md:text-left">
                    Score: <span id="score">0</span> / <span id="total-questions">0</span>
                </div>

                <!-- Options Container -->
                <div id="options-container" class="grid grid-cols-1 sm:grid-cols-2 gap-3 mb-4">
                    <!-- Answer buttons will be dynamically inserted here -->
                </div>

                <!-- Feedback and Next Button -->
                <div id="feedback-container" class="mt-auto">
                     <p id="feedback-text" class="text-xl text-center md:text-left font-bold mb-2 min-h-[28px]"></p>
                     <button id="next-question-btn" class="hidden w-full bg-amber-800 text-white font-bold py-3 px-6 rounded-lg hover:bg-amber-900 transition duration-300 ease-in-out transform hover:scale-105">
                        Next Question
                    </button>
                </div>
            </div>
        </div>
    </main>

    <script>
        // --- DATA SETUP ---
        // An array of objects, each representing a WBC type and the number of images available.
        // NOTE: You can change the 'count' for each cell type based on how many images you have.
        // The image files should be named like "Lymph1.png", "Lymph2.png", etc.
        const wbcTypes = [
            { name: "Lymph", count: 6 },
            { name: "Seg", count: 5 },
            { name: "Band", count: 5 },
            { name: "Basophil", count: 6 },
            { name: "Eos", count: 6 },
            { name: "Mono", count: 7 },
            { name: "Atl", count: 6 },
            { name: "Blast", count: 5 },
            { name: "Bar", count: 5 },
            { name: "Prom", count: 5 },
            { name: "Myelo", count: 6 },
            { name: "Meta", count: 5 },
            { name: "H-Seg", count: 5 }
        ];

        // --- DOM ELEMENT REFERENCES ---
        const wbcImage = document.getElementById('wbc-image');
        const optionsContainer = document.getElementById('options-container');
        const feedbackText = document.getElementById('feedback-text');
        const nextQuestionBtn = document.getElementById('next-question-btn');
        const scoreEl = document.getElementById('score');
        const totalQuestionsEl = document.getElementById('total-questions');

        // --- STATE MANAGEMENT ---
        let currentCorrectAnswer = '';
        let score = 0;
        let totalQuestions = 0;
        let isAnswered = false;

        // --- HELPER FUNCTIONS ---
        /**
         * Generates a random integer between 0 and a max value (exclusive).
         * @param {number} max - The upper bound for the random number.
         * @returns {number} A random integer.
         */
        function getRandomInt(max) {
            return Math.floor(Math.random() * max);
        }

        /**
         * Shuffles an array in place using the Fisher-Yates algorithm.
         * @param {Array} array - The array to be shuffled.
         */
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }

        // --- CORE QUIZ LOGIC ---
        /**
         * Generates and displays a new quiz question.
         */
        function generateQuestion() {
            // 1. Reset the UI state
            isAnswered = false;
            feedbackText.textContent = '';
            nextQuestionBtn.classList.add('hidden');
            optionsContainer.innerHTML = ''; // Clear previous options
            optionsContainer.classList.remove('disabled-options');

            // 2. Select a random WBC type for the correct answer
            const correctTypeIndex = getRandomInt(wbcTypes.length);
            const correctType = wbcTypes[correctTypeIndex];
            currentCorrectAnswer = correctType.name;

            // 3. Select a random image number for that type
            const imageNumber = getRandomInt(correctType.count) + 1; // +1 because counts are 1-based
            const imageName = `${correctType.name}${imageNumber}.png`;
            
            // 4. Update the image source
            // This now combines the 'cells' folder path with the generated image name.
            wbcImage.src = `cells/${imageName}`;
            wbcImage.alt = `Image of a ${correctType.name}`;

            // 5. Generate answer options (1 correct, 3 incorrect)
            const options = [correctType.name];
            const wrongTypes = wbcTypes.filter(type => type.name !== correctType.name);
            shuffleArray(wrongTypes); // Randomize the incorrect options
            for (let i = 0; i < 3; i++) {
                options.push(wrongTypes[i].name);
            }
            
            shuffleArray(options); // Shuffle the final list of 4 options

            // 6. Create and display the answer buttons
            options.forEach(option => {
                const button = document.createElement('button');
                button.textContent = option;
                button.classList.add('w-full', 'bg-stone-50', 'text-stone-700', 'font-semibold', 'py-3', 'px-4', 'border', 'border-stone-300', 'rounded-lg', 'shadow-sm', 'hover:bg-stone-100', 'transition', 'duration-200');
                button.onclick = () => checkAnswer(option, button);
                optionsContainer.appendChild(button);
            });
        }

        /**
         * Checks the user's selected answer against the correct answer.
         * @param {string} selectedOption - The text content of the button the user clicked.
         * @param {HTMLElement} buttonElement - The button element that was clicked.
         */
        function checkAnswer(selectedOption, buttonElement) {
            if (isAnswered) return; // Prevent multiple clicks
            isAnswered = true;

            totalQuestions++;
            totalQuestionsEl.textContent = totalQuestions;
            optionsContainer.classList.add('disabled-options');

            if (selectedOption === currentCorrectAnswer) {
                // Correct Answer
                score++;
                scoreEl.textContent = score;
                feedbackText.textContent = 'Correct!';
                feedbackText.classList.add('text-green-500');
                feedbackText.classList.remove('text-red-500');
                buttonElement.classList.add('correct-answer');
            } else {
                // Incorrect Answer
                feedbackText.textContent = `Incorrect! The answer was ${currentCorrectAnswer}.`;
                feedbackText.classList.add('text-red-500');
                feedbackText.classList.remove('text-green-500');
                buttonElement.classList.add('wrong-answer');
                
                // Highlight the correct answer
                Array.from(optionsContainer.children).forEach(btn => {
                    if (btn.textContent === currentCorrectAnswer) {
                        btn.classList.add('correct-answer');
                    }
                });
            }

            // Show the "Next Question" button
            nextQuestionBtn.classList.remove('hidden');
        }

        // --- EVENT LISTENERS ---
        nextQuestionBtn.addEventListener('click', generateQuestion);

        // --- INITIALIZATION ---
        // Load the first question when the page loads
        window.onload = generateQuestion;
    </script>

</body>
</html>
